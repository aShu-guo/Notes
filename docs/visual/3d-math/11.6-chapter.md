# 多边形

对于多边形并没有一个准确的定义，一般来说，多边形是由顶点和边构成的平面物体

## 简单多边形和复杂多边形

简单多边形是`不包含“洞”的`，反之复杂多边形是`包含的`。

![img.png](/imgs/visual/3d-math/geometry-polygon.png)

但是复杂多边形可以通过`分割`转换为简单多边形

![img.png](/imgs/visual/3d-math/geometry-polygon-1.png)

## 自相交多边形

大多数简单多边形是不与自己相交的，而且我们并不经常与自相交多边形打交道

![img.png](/imgs/visual/3d-math/geometry-polygon-2.png)

## 凸多边形和凹多边形

非自相交多边形又可以分为`凸多边形`和`凹多边形`，但是由于存在`退化四边形`，对于凹凸并没有准确的定义，但是我们给出以下常见定义：

- 直观上，凸多边形是没有任何“凹陷点”的，凹多边形是至少有一个“凹陷点”
- 凸多边形任意两点的连线都是在四边形内部，凹多边形至少存在两个点的连线其中一部分是在四边形外部的
- 沿多边形周边移动时，凸多边形的方向转向总是一致的，凹多边形方向并不是一致的（假设你是小汽车的驾驶员，沿着周边移动），但是这只针对非自相交多边形

而且为了减少凹凸多边形退化导致的检查模糊问题，我们约定

- 只对凸多边形有效的代码，对于这个多边形也有效，那么这个多边形是凸多边形
- 如果凸多边形测试的代码中检查到这个多边形是凸多边形，那么它就是凸多边形

### 凹凸检查

根据给出的凹凸多边形的定义，有三种方式

#### 凹陷点

判断多边形是否有凹陷点，有则为凹多边形，反之为凸多边形

#### 转向

向量的点乘可以计算某两个边构成的法向量，并根据

- 凸四边形中所有点的法向量与凸四边形所在平面的法向量的点乘是正直，即方向相同
- 凸四边形为负值，即方向不同

<iframe src="https://www.geogebra.org/3d/cda2bzgm?embed" width="800" height="600" allowfullscreen style="border: 1px solid #e4e4e4;border-radius: 4px;" frameborder="0"></iframe>

#### 内角和

对于任意一个`n多边形`，它有`n个顶点`，那么通过顶点之间的连线可以切割成`n-2个`三角形，则这个n多边形的内角和为`(n-2)*180`

![img.png](/imgs/visual/3d-math/geometry-polygon-3.png)

但是`凸多边形和凹多边形`的内角和都是(n-2)\*180，为了解决这个问题，我们取每个顶点最小的角（包含图中标出的两个角）

- 凸多边形：每个顶点最小的角之和`是`(n-2)\*180
- 凸多边形：每个顶点最小的角之和`小于`(n-2)\*180

![img.png](/imgs/visual/3d-math/geometry-polygon-5.png)

而`点乘`可以计算出两个向量的夹角，从而判断出最小的弧度值

<<< @/visual/3d-math/codes/isConvex.ts

## 三角分解和扇形分解

任意多边形都可以分解成多个三角形，但是对于复杂、自相交甚至简单多边形都不是一件容易的事情。

为了方便起见，我们任意选择一个简单多边形，并在多边形中任选一个顶点作为起点，连接其他顶点将多边形切分成多个“细长”的三角形

![img.png](/imgs/visual/3d-math/geometry-polygon-6.png)

:::info

1. 什么是退化？

在定义限制下，属于一个集合中的对象由于`性质改变`而`变成`另外一个集合的对象，一般情况是`变成简单集合的对象`

例如：

点是退化的圆，因为一个圆若半径为0就会成一个点

圆是退化的椭圆，因为它的离心率是0

线是退化的抛物线，因为抛物线在切空间中呈一直线

2. 什么是内角、外角、补角？

内角：多边形内部的角

外角：多边形内角邻边延长线构成的角

补角：形容一种角之间的关系，互为补角，简称为互补角，内角+外角=180

<img src="/imgs/visual/3d-math/geometry-polygon-4.png" style="background: white"/>

:::

参考：

【1】[退化多边形](https://zh.wikipedia.org/wiki/%E9%80%80%E5%8C%96%E5%A4%9A%E9%82%8A%E5%BD%A2)

【2】[退化](<https://zh.wikipedia.org/wiki/%E9%80%80%E5%8C%96_(%E6%95%B8%E5%AD%B8)>)
